[{"clean":"query = 'SELECT * FROM users WHERE name = ?'; cursor.execute(query, (user_input,))","corrupted":"query = 'SELECT * FROM users WHERE name = ' + user_input; cursor.execute(query)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['ls', '-l', user_dir])","corrupted":"import os; os.system('ls -l ' + user_dir)","clean_label":0,"corrupted_label":1},{"clean":"import ast; user_data = ast.literal_eval(user_string)","corrupted":"user_data = eval(user_string)","clean_label":0,"corrupted_label":1},{"clean":"import yaml; data = yaml.safe_load(yaml_file)","corrupted":"import yaml; data = yaml.load(yaml_file)","clean_label":0,"corrupted_label":1},{"clean":"import os; safe_path = os.path.basename(user_file); open(safe_path, 'r')","corrupted":"import os; open(user_file, 'r')","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.sha256(); h.update(password.encode())","corrupted":"import hashlib; h = hashlib.md5(); h.update(password.encode())","clean_label":0,"corrupted_label":1},{"clean":"sql = 'UPDATE accounts SET balance = ? WHERE id = ?'; db.execute(sql, (bal, uid))","corrupted":"sql = f'UPDATE accounts SET balance = {bal} WHERE id = {uid}'; db.execute(sql)","clean_label":0,"corrupted_label":1},{"clean":"import html; safe_text = html.escape(user_comment); print(safe_text)","corrupted":"print(user_comment)","clean_label":0,"corrupted_label":1},{"clean":"from werkzeug.utils import secure_filename; fname = secure_filename(f.name)","corrupted":"fname = f.name","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['ping', '-c', '4', user_ip])","corrupted":"import os; os.popen('ping -c 4 ' + user_ip)","clean_label":0,"corrupted_label":1},{"clean":"import xml.etree.ElementTree as ET; tree = ET.parse(file)","corrupted":"import lxml.etree as ET; tree = ET.parse(file)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; token = secrets.token_hex(16)","corrupted":"import random; token = hex(random.getrandbits(128))","clean_label":0,"corrupted_label":1},{"clean":"query = 'DELETE FROM logs WHERE date < %s'; cursor.execute(query, (cutoff,))","corrupted":"query = 'DELETE FROM logs WHERE date < ' + cutoff; cursor.execute(query)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.call(['echo', user_msg])","corrupted":"import os; os.system('echo ' + user_msg)","clean_label":0,"corrupted_label":1},{"clean":"import json; parsed = json.loads(user_input)","corrupted":"parsed = eval(user_input)","clean_label":0,"corrupted_label":1},{"clean":"import sqlite3; conn.execute('SELECT id FROM admins WHERE name=?', (name,))","corrupted":"import sqlite3; conn.execute('SELECT id FROM admins WHERE name=\"%s\"' % name)","clean_label":0,"corrupted_label":1},{"clean":"from cryptography.fernet import Fernet; key = Fernet.generate_key()","corrupted":"key = 'super_secret_hardcoded_key_123'","clean_label":0,"corrupted_label":1},{"clean":"import requests; r = requests.get(url, verify=True)","corrupted":"import requests; r = requests.get(url, verify=False)","clean_label":0,"corrupted_label":1},{"clean":"import urllib.parse; safe_url = urllib.parse.quote(user_url)","corrupted":"safe_url = user_url","clean_label":0,"corrupted_label":1},{"clean":"db.execute('INSERT INTO posts (title, body) VALUES (?, ?)', (t, b))","corrupted":"db.execute(f'INSERT INTO posts (title, body) VALUES (\"{t}\", \"{b}\")')","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; out = subprocess.check_output(['df', '-h', target])","corrupted":"import os; out = os.popen('df -h ' + target).read()","clean_label":0,"corrupted_label":1},{"clean":"import ast; config = ast.literal_eval(config_string)","corrupted":"config = eval(config_string)","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; m = hashlib.sha512(); m.update(data)","corrupted":"import hashlib; m = hashlib.sha1(); m.update(data)","clean_label":0,"corrupted_label":1},{"clean":"import os; os.chmod('config.json', 0o600)","corrupted":"import os; os.chmod('config.json', 0o777)","clean_label":0,"corrupted_label":1},{"clean":"query = 'SELECT pass FROM staff WHERE user = :1'; cursor.execute(query, {'1': u})","corrupted":"query = 'SELECT pass FROM staff WHERE user = ' + u; cursor.execute(query)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['cat', file_path])","corrupted":"import os; os.system('cat ' + file_path)","clean_label":0,"corrupted_label":1},{"clean":"def parse_math(expr): return ast.literal_eval(expr)","corrupted":"def parse_math(expr): return eval(expr)","clean_label":0,"corrupted_label":1},{"clean":"app.config['SECRET_KEY'] = os.environ.get('SECRET_KEY')","corrupted":"app.config['SECRET_KEY'] = 'dev_key_do_not_use_in_prod'","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM items WHERE price > %s', (min_price,))","corrupted":"cursor.execute('SELECT * FROM items WHERE price > ' + min_price)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['netstat', '-an'])","corrupted":"import os; os.system('netstat -an')","clean_label":0,"corrupted_label":1},{"clean":"import pickle; data = pickle.loads(trusted_bytes, fix_imports=False)","corrupted":"import pickle; data = pickle.loads(untrusted_network_bytes)","clean_label":0,"corrupted_label":1},{"clean":"import bcrypt; hashed = bcrypt.hashpw(password.encode(), bcrypt.gensalt())","corrupted":"hashed = password.encode()","clean_label":0,"corrupted_label":1},{"clean":"response.set_cookie('session', token, httponly=True, secure=True)","corrupted":"response.set_cookie('session', token)","clean_label":0,"corrupted_label":1},{"clean":"import re; safe_input = re.escape(user_pattern); re.search(safe_input, text)","corrupted":"import re; re.search(user_pattern, text)","clean_label":0,"corrupted_label":1},{"clean":"import tempfile; fd, path = tempfile.mkstemp(); os.write(fd, data)","corrupted":"path = '/tmp/myapp_' + username; open(path, 'w').write(data)","clean_label":0,"corrupted_label":1},{"clean":"conn = psycopg2.connect(host=db_host, sslmode='require')","corrupted":"conn = psycopg2.connect(host=db_host, sslmode='disable')","clean_label":0,"corrupted_label":1},{"clean":"import hmac; valid = hmac.compare_digest(expected_sig, received_sig)","corrupted":"valid = (expected_sig == received_sig)","clean_label":0,"corrupted_label":1},{"clean":"import logging; logging.info('Login attempt for user %s', username)","corrupted":"import logging; logging.info(f'Login attempt with password {password}')","clean_label":0,"corrupted_label":1},{"clean":"app.run(debug=False)","corrupted":"app.run(debug=True)","clean_label":0,"corrupted_label":1},{"clean":"import ssl; ctx = ssl.create_default_context()","corrupted":"import ssl; ctx = ssl._create_unverified_context()","clean_label":0,"corrupted_label":1},{"clean":"from markupsafe import escape; output = escape(user_input)","corrupted":"output = user_input","clean_label":0,"corrupted_label":1},{"clean":"import jwt; payload = jwt.decode(token, secret, algorithms=['HS256'])","corrupted":"import jwt; payload = jwt.decode(token, options={'verify_signature': False})","clean_label":0,"corrupted_label":1},{"clean":"import os; real_path = os.path.realpath(user_path); assert real_path.startswith('/safe/')","corrupted":"import os; open(user_path, 'r')","clean_label":0,"corrupted_label":1},{"clean":"from jinja2 import Environment; env = Environment(autoescape=True)","corrupted":"from jinja2 import Environment; env = Environment(autoescape=False)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['grep', pattern, filename])","corrupted":"import os; os.system('grep ' + pattern + ' ' + filename)","clean_label":0,"corrupted_label":1},{"clean":"query = 'SELECT email FROM users WHERE uid = %s'; cursor.execute(query, (uid,))","corrupted":"query = f'SELECT email FROM users WHERE uid = {uid}'; cursor.execute(query)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; otp = secrets.randbelow(1000000)","corrupted":"import random; otp = random.randint(0, 999999)","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; digest = hashlib.pbkdf2_hmac('sha256', pw, salt, 100000)","corrupted":"import hashlib; digest = hashlib.md5(pw).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM orders WHERE cust_id = ? AND status = ?', (cid, st))","corrupted":"db.execute('SELECT * FROM orders WHERE cust_id = ' + cid + ' AND status = ' + st)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_call(['rm', '-f', temp_file])","corrupted":"import os; os.system('rm -f ' + temp_file)","clean_label":0,"corrupted_label":1},{"clean":"import ast; result = ast.literal_eval(user_expression)","corrupted":"result = exec(user_expression)","clean_label":0,"corrupted_label":1},{"clean":"import os; db_pass = os.environ['DB_PASSWORD']","corrupted":"db_pass = 'admin123'","clean_label":0,"corrupted_label":1},{"clean":"from defusedxml import ElementTree; tree = ElementTree.parse(xml_file)","corrupted":"from xml.etree.ElementTree import parse; tree = parse(xml_file)","clean_label":0,"corrupted_label":1},{"clean":"response.headers['X-Content-Type-Options'] = 'nosniff'","corrupted":"pass","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; result = subprocess.run(['find', search_dir, '-name', pattern])","corrupted":"import os; result = os.popen('find ' + search_dir + ' -name ' + pattern).read()","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('INSERT INTO audit (action, user) VALUES (?, ?)', (act, usr))","corrupted":"cursor.execute(f'INSERT INTO audit (action, user) VALUES (\"{act}\", \"{usr}\")')","clean_label":0,"corrupted_label":1},{"clean":"import secrets; reset_token = secrets.token_urlsafe(32)","corrupted":"import random; reset_token = str(random.random())","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.sha3_256(data).hexdigest()","corrupted":"import hashlib; h = hashlib.md5(data).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"import html; display = html.escape(user_bio)","corrupted":"display = user_bio","clean_label":0,"corrupted_label":1},{"clean":"import os; allowed = ['/uploads/', '/public/']; assert any(user_path.startswith(d) for d in allowed)","corrupted":"import os; f = open(user_path, 'rb')","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['wget', '-q', url, '-O', output])","corrupted":"import os; os.system('wget -q ' + url + ' -O ' + output)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('UPDATE users SET email = ? WHERE id = ?', (email, uid))","corrupted":"db.execute(f'UPDATE users SET email = \"{email}\" WHERE id = {uid}')","clean_label":0,"corrupted_label":1},{"clean":"import bcrypt; valid = bcrypt.checkpw(password.encode(), stored_hash)","corrupted":"valid = (password == stored_password)","clean_label":0,"corrupted_label":1},{"clean":"response.headers['Content-Security-Policy'] = \"default-src 'self'\"","corrupted":"response.headers['Content-Security-Policy'] = \"default-src *\"","clean_label":0,"corrupted_label":1},{"clean":"import json; settings = json.loads(config_text)","corrupted":"settings = eval(config_text)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['tar', '-xzf', archive, '-C', dest])","corrupted":"import os; os.system('tar -xzf ' + archive + ' -C ' + dest)","clean_label":0,"corrupted_label":1},{"clean":"query = 'SELECT * FROM products WHERE category = ?'; cur.execute(query, (cat,))","corrupted":"query = 'SELECT * FROM products WHERE category = \"' + cat + '\"'; cur.execute(query)","clean_label":0,"corrupted_label":1},{"clean":"import ssl; context = ssl.SSLContext(ssl.PROTOCOL_TLS_CLIENT)","corrupted":"import ssl; context = ssl.SSLContext(ssl.PROTOCOL_SSLv23)","clean_label":0,"corrupted_label":1},{"clean":"from werkzeug.security import generate_password_hash; h = generate_password_hash(pw)","corrupted":"h = pw","clean_label":0,"corrupted_label":1},{"clean":"import os; safe = os.path.normpath(user_path); assert not safe.startswith('..')","corrupted":"f = open(user_path, 'r')","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_output(['curl', '-s', api_url])","corrupted":"import os; os.popen('curl -s ' + api_url).read()","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM sessions WHERE token = %s', (session_tok,))","corrupted":"cursor.execute('SELECT * FROM sessions WHERE token = \"' + session_tok + '\"')","clean_label":0,"corrupted_label":1},{"clean":"import secrets; api_key = secrets.token_hex(32)","corrupted":"import random; api_key = ''.join(random.choices('abcdef0123456789', k=64))","clean_label":0,"corrupted_label":1},{"clean":"import html; safe_title = html.escape(post_title); render(safe_title)","corrupted":"render(post_title)","clean_label":0,"corrupted_label":1},{"clean":"import yaml; conf = yaml.safe_load(open('config.yml'))","corrupted":"import yaml; conf = yaml.load(open('config.yml'))","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['chmod', '600', keyfile])","corrupted":"import os; os.system('chmod 777 ' + keyfile)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT balance FROM wallets WHERE owner = ?', (owner_id,))","corrupted":"db.execute('SELECT balance FROM wallets WHERE owner = ' + owner_id)","clean_label":0,"corrupted_label":1},{"clean":"from markupsafe import escape; msg = escape(flash_message)","corrupted":"msg = flash_message","clean_label":0,"corrupted_label":1},{"clean":"import os; token = os.urandom(24).hex()","corrupted":"import time; token = str(int(time.time()))","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['scp', src, dest])","corrupted":"import os; os.system('scp ' + src + ' ' + dest)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('INSERT INTO comments (text, author) VALUES (%s, %s)', (txt, auth))","corrupted":"cursor.execute('INSERT INTO comments (text, author) VALUES (\"' + txt + '\", \"' + auth + '\")')","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; sig = hashlib.blake2b(msg, key=secret_key).hexdigest()","corrupted":"import hashlib; sig = hashlib.md5(msg).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"app.config['SESSION_COOKIE_SECURE'] = True","corrupted":"app.config['SESSION_COOKIE_SECURE'] = False","clean_label":0,"corrupted_label":1},{"clean":"import re; safe = re.escape(user_regex); compiled = re.compile(safe)","corrupted":"import re; compiled = re.compile(user_regex)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.call(['zip', '-r', archive_name, folder])","corrupted":"import os; os.system('zip -r ' + archive_name + ' ' + folder)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('DELETE FROM tokens WHERE user_id = ? AND expired = ?', (uid, 1))","corrupted":"db.execute(f'DELETE FROM tokens WHERE user_id = {uid} AND expired = 1')","clean_label":0,"corrupted_label":1},{"clean":"import json; user_prefs = json.loads(prefs_string)","corrupted":"user_prefs = eval(prefs_string)","clean_label":0,"corrupted_label":1},{"clean":"import os; api_secret = os.getenv('API_SECRET')","corrupted":"api_secret = 'sk_live_abc123xyz'","clean_label":0,"corrupted_label":1},{"clean":"import hmac; mac = hmac.new(key, msg, 'sha256').hexdigest()","corrupted":"mac = key + msg","clean_label":0,"corrupted_label":1},{"clean":"response.set_cookie('auth', value, samesite='Strict', httponly=True)","corrupted":"response.set_cookie('auth', value, samesite='None')","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['rsync', '-a', source, destination])","corrupted":"import os; os.system('rsync -a ' + source + ' ' + destination)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT role FROM members WHERE name = ?', (member_name,))","corrupted":"cursor.execute('SELECT role FROM members WHERE name = \"' + member_name + '\"')","clean_label":0,"corrupted_label":1},{"clean":"import secrets; nonce = secrets.token_bytes(16)","corrupted":"import random; nonce = bytes([random.randint(0,255) for _ in range(16)])","clean_label":0,"corrupted_label":1},{"clean":"from defusedxml.minidom import parseString; doc = parseString(xml_data)","corrupted":"from xml.dom.minidom import parseString; doc = parseString(xml_data)","clean_label":0,"corrupted_label":1},{"clean":"import html; clean_input = html.escape(search_query); show(clean_input)","corrupted":"show(search_query)","clean_label":0,"corrupted_label":1},{"clean":"import os; real = os.path.realpath(p); assert real.startswith(UPLOAD_DIR)","corrupted":"open(p, 'rb').read()","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_call(['mv', old_name, new_name])","corrupted":"import os; os.system('mv ' + old_name + ' ' + new_name)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('UPDATE inventory SET qty = ? WHERE sku = ?', (qty, sku))","corrupted":"db.execute(f'UPDATE inventory SET qty = {qty} WHERE sku = \"{sku}\"')","clean_label":0,"corrupted_label":1},{"clean":"import ast; value = ast.literal_eval(raw_value)","corrupted":"value = eval(raw_value)","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.scrypt(pw, salt=salt, n=16384, r=8, p=1)","corrupted":"h = pw","clean_label":0,"corrupted_label":1},{"clean":"response.headers['Strict-Transport-Security'] = 'max-age=31536000'","corrupted":"pass","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['cp', src_file, dst_file])","corrupted":"import os; os.system('cp ' + src_file + ' ' + dst_file)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM events WHERE date BETWEEN ? AND ?', (start, end))","corrupted":"cursor.execute('SELECT * FROM events WHERE date BETWEEN ' + start + ' AND ' + end)","clean_label":0,"corrupted_label":1},{"clean":"import json; data = json.loads(api_response)","corrupted":"data = eval(api_response)","clean_label":0,"corrupted_label":1},{"clean":"from jinja2 import escape; safe_name = escape(display_name)","corrupted":"safe_name = display_name","clean_label":0,"corrupted_label":1},{"clean":"import yaml; schema = yaml.safe_load(schema_text)","corrupted":"import yaml; schema = yaml.load(schema_text)","clean_label":0,"corrupted_label":1},{"clean":"import os; fname = os.path.basename(uploaded_name); save_to(fname)","corrupted":"save_to(uploaded_name)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['git', 'clone', repo_url, dest_dir])","corrupted":"import os; os.system('git clone ' + repo_url + ' ' + dest_dir)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT hash FROM credentials WHERE login = ?', (login,))","corrupted":"db.execute('SELECT hash FROM credentials WHERE login = \"' + login + '\"')","clean_label":0,"corrupted_label":1},{"clean":"import secrets; csrf_token = secrets.token_urlsafe(24)","corrupted":"import random; csrf_token = str(random.randint(100000, 999999))","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; tag = hashlib.sha256(payload.encode()).hexdigest()","corrupted":"import hashlib; tag = hashlib.md5(payload.encode()).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"import html; escaped = html.escape(error_message); return escaped","corrupted":"return error_message","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['unzip', archive, '-d', out_dir])","corrupted":"import os; os.system('unzip ' + archive + ' -d ' + out_dir)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('INSERT INTO logs (ip, action) VALUES (?, ?)', (ip_addr, action))","corrupted":"cursor.execute(f'INSERT INTO logs (ip, action) VALUES (\"{ip_addr}\", \"{action}\")')","clean_label":0,"corrupted_label":1},{"clean":"import os; db_url = os.environ.get('DATABASE_URL')","corrupted":"db_url = 'postgres://admin:password@localhost/mydb'","clean_label":0,"corrupted_label":1},{"clean":"import jwt; claims = jwt.decode(token, pub_key, algorithms=['RS256'])","corrupted":"import jwt; claims = jwt.decode(token, pub_key, algorithms=['none'])","clean_label":0,"corrupted_label":1},{"clean":"response.set_cookie('prefs', val, httponly=True, samesite='Lax')","corrupted":"response.set_cookie('prefs', val)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_output(['wc', '-l', logfile])","corrupted":"import os; os.popen('wc -l ' + logfile).read()","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM tickets WHERE assigned = ? AND open = ?', (agent, 1))","corrupted":"db.execute('SELECT * FROM tickets WHERE assigned = \"' + agent + '\" AND open = 1')","clean_label":0,"corrupted_label":1},{"clean":"import ast; obj = ast.literal_eval(serialized_obj)","corrupted":"obj = eval(serialized_obj)","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.sha384(content).hexdigest()","corrupted":"import hashlib; h = hashlib.sha1(content).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['ssh', user_host, remote_cmd])","corrupted":"import os; os.system('ssh ' + user_host + ' ' + remote_cmd)","clean_label":0,"corrupted_label":1},{"clean":"from markupsafe import escape; label = escape(category_name)","corrupted":"label = category_name","clean_label":0,"corrupted_label":1},{"clean":"import json; rules = json.loads(rules_text)","corrupted":"rules = eval(rules_text)","clean_label":0,"corrupted_label":1},{"clean":"import os; path = os.path.join(BASE_DIR, os.path.basename(name))","corrupted":"path = os.path.join(BASE_DIR, name)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['docker', 'run', '--rm', image_name])","corrupted":"import os; os.system('docker run --rm ' + image_name)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('UPDATE settings SET val = ? WHERE key = ?', (val, key))","corrupted":"cursor.execute(f'UPDATE settings SET val = \"{val}\" WHERE key = \"{key}\"')","clean_label":0,"corrupted_label":1},{"clean":"import bcrypt; pw_hash = bcrypt.hashpw(raw_pw.encode(), bcrypt.gensalt(12))","corrupted":"pw_hash = raw_pw.encode()","clean_label":0,"corrupted_label":1},{"clean":"app.config['SESSION_COOKIE_HTTPONLY'] = True","corrupted":"app.config['SESSION_COOKIE_HTTPONLY'] = False","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.call(['chown', owner, target_file])","corrupted":"import os; os.system('chown ' + owner + ' ' + target_file)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT count(*) FROM votes WHERE poll_id = ?', (poll_id,))","corrupted":"db.execute('SELECT count(*) FROM votes WHERE poll_id = ' + poll_id)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; invite_code = secrets.token_urlsafe(16)","corrupted":"import random; invite_code = str(random.random()).replace('0.', '')","clean_label":0,"corrupted_label":1},{"clean":"import html; sanitized = html.escape(review_text); store(sanitized)","corrupted":"store(review_text)","clean_label":0,"corrupted_label":1},{"clean":"import yaml; data = yaml.safe_load(user_yaml)","corrupted":"import yaml; data = yaml.load(user_yaml)","clean_label":0,"corrupted_label":1},{"clean":"from defusedxml.sax import parse; parse(xml_source, handler)","corrupted":"from xml.sax import parse; parse(xml_source, handler)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['kill', '-9', pid_str])","corrupted":"import os; os.system('kill -9 ' + pid_str)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM messages WHERE sender = ? ORDER BY ts', (sender,))","corrupted":"cursor.execute('SELECT * FROM messages WHERE sender = \"' + sender + '\" ORDER BY ts')","clean_label":0,"corrupted_label":1},{"clean":"import os; enc_key = os.urandom(32)","corrupted":"enc_key = b'0123456789abcdef0123456789abcdef'","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; checksum = hashlib.sha256(file_bytes).hexdigest()","corrupted":"import hashlib; checksum = hashlib.md5(file_bytes).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_output(['du', '-sh', directory])","corrupted":"import os; os.popen('du -sh ' + directory).read()","clean_label":0,"corrupted_label":1},{"clean":"db.execute('INSERT INTO feedback (rating, comment) VALUES (?, ?)', (r, c))","corrupted":"db.execute(f'INSERT INTO feedback (rating, comment) VALUES ({r}, \"{c}\")')","clean_label":0,"corrupted_label":1},{"clean":"import json; metadata = json.loads(meta_string)","corrupted":"metadata = eval(meta_string)","clean_label":0,"corrupted_label":1},{"clean":"import html; safe_desc = html.escape(product_desc)","corrupted":"safe_desc = product_desc","clean_label":0,"corrupted_label":1},{"clean":"import os; real = os.path.realpath(fp); assert SAFE_DIR in real","corrupted":"data = open(fp).read()","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['mysql', '-u', user, '-p', passwd, db])","corrupted":"import os; os.system('mysql -u ' + user + ' -p ' + passwd + ' ' + db)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM catalog WHERE brand = ? LIMIT ?', (brand, n))","corrupted":"cursor.execute('SELECT * FROM catalog WHERE brand = \"' + brand + '\" LIMIT ' + n)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; session_id = secrets.token_hex(24)","corrupted":"import random; session_id = hex(random.getrandbits(192))","clean_label":0,"corrupted_label":1},{"clean":"import ast; dimensions = ast.literal_eval(dim_string)","corrupted":"dimensions = eval(dim_string)","clean_label":0,"corrupted_label":1},{"clean":"response.headers['X-Frame-Options'] = 'DENY'","corrupted":"pass","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['sed', '-i', pattern, config_file])","corrupted":"import os; os.system('sed -i ' + pattern + ' ' + config_file)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM tasks WHERE project = ? AND done = ?', (proj, 0))","corrupted":"db.execute('SELECT * FROM tasks WHERE project = \"' + proj + '\" AND done = 0')","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.sha256(); h.update(token.encode()); h.hexdigest()","corrupted":"import hashlib; h = hashlib.md5(); h.update(token.encode()); h.hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"from markupsafe import escape; snippet = escape(code_preview)","corrupted":"snippet = code_preview","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_call(['pg_dump', '-U', usr, dbname])","corrupted":"import os; os.system('pg_dump -U ' + usr + ' ' + dbname)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM reservations WHERE guest = ? AND date = ?', (g, d))","corrupted":"cursor.execute(f'SELECT * FROM reservations WHERE guest = \"{g}\" AND date = \"{d}\"')","clean_label":0,"corrupted_label":1},{"clean":"import os; smtp_pass = os.environ.get('SMTP_PASSWORD')","corrupted":"smtp_pass = 'mail_password_2024'","clean_label":0,"corrupted_label":1},{"clean":"import json; filters = json.loads(filter_json)","corrupted":"filters = eval(filter_json)","clean_label":0,"corrupted_label":1},{"clean":"import yaml; pipeline = yaml.safe_load(pipeline_yaml)","corrupted":"import yaml; pipeline = yaml.load(pipeline_yaml)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['aws', 's3', 'cp', local, remote])","corrupted":"import os; os.system('aws s3 cp ' + local + ' ' + remote)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT avg(score) FROM reviews WHERE product_id = ?', (pid,))","corrupted":"db.execute('SELECT avg(score) FROM reviews WHERE product_id = ' + pid)","clean_label":0,"corrupted_label":1},{"clean":"import html; safe_reply = html.escape(reply_body); send(safe_reply)","corrupted":"send(reply_body)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; verification_code = secrets.randbelow(900000) + 100000","corrupted":"import random; verification_code = random.randint(100000, 999999)","clean_label":0,"corrupted_label":1},{"clean":"import os; basename = os.path.basename(attachment_name); write_file(basename)","corrupted":"write_file(attachment_name)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_output(['head', '-n', '100', big_file])","corrupted":"import os; os.popen('head -n 100 ' + big_file).read()","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('INSERT INTO bookmarks (url, title) VALUES (?, ?)', (url, ttl))","corrupted":"cursor.execute(f'INSERT INTO bookmarks (url, title) VALUES (\"{url}\", \"{ttl}\")')","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; digest = hashlib.pbkdf2_hmac('sha512', pw, s, 200000)","corrupted":"digest = pw","clean_label":0,"corrupted_label":1},{"clean":"import hmac; ok = hmac.compare_digest(computed_mac, received_mac)","corrupted":"ok = (computed_mac == received_mac)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['ffmpeg', '-i', infile, outfile])","corrupted":"import os; os.system('ffmpeg -i ' + infile + ' ' + outfile)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM employees WHERE dept = ? AND active = ?', (dept, 1))","corrupted":"db.execute('SELECT * FROM employees WHERE dept = \"' + dept + '\" AND active = 1')","clean_label":0,"corrupted_label":1},{"clean":"import ast; coords = ast.literal_eval(coord_string)","corrupted":"coords = eval(coord_string)","clean_label":0,"corrupted_label":1},{"clean":"import ssl; ctx = ssl.create_default_context(); ctx.check_hostname = True","corrupted":"import ssl; ctx = ssl.create_default_context(); ctx.check_hostname = False","clean_label":0,"corrupted_label":1},{"clean":"from markupsafe import escape; title = escape(article_title)","corrupted":"title = article_title","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['openssl', 'enc', '-aes-256-cbc', '-in', f])","corrupted":"import os; os.system('openssl enc -aes-256-cbc -in ' + f)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('SELECT * FROM addresses WHERE zip = ? AND city = ?', (z, city))","corrupted":"cursor.execute(f'SELECT * FROM addresses WHERE zip = \"{z}\" AND city = \"{city}\"')","clean_label":0,"corrupted_label":1},{"clean":"import os; redis_pass = os.getenv('REDIS_PASSWORD')","corrupted":"redis_pass = 'redis_default_pass'","clean_label":0,"corrupted_label":1},{"clean":"import json; mapping = json.loads(map_str)","corrupted":"mapping = eval(map_str)","clean_label":0,"corrupted_label":1},{"clean":"import yaml; template = yaml.safe_load(tmpl_str)","corrupted":"import yaml; template = yaml.load(tmpl_str)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.check_call(['python3', script_path])","corrupted":"import os; os.system('python3 ' + script_path)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM transactions WHERE account = ? AND amount > ?', (acct, m))","corrupted":"db.execute('SELECT * FROM transactions WHERE account = ' + acct + ' AND amount > ' + m)","clean_label":0,"corrupted_label":1},{"clean":"import html; escaped_addr = html.escape(address_line); display(escaped_addr)","corrupted":"display(address_line)","clean_label":0,"corrupted_label":1},{"clean":"import secrets; link_token = secrets.token_urlsafe(20)","corrupted":"import random; link_token = ''.join(random.choices('abcdefghijklmnopqrstuvwxyz', k=20))","clean_label":0,"corrupted_label":1},{"clean":"import os; clean_name = os.path.basename(download_name); serve(clean_name)","corrupted":"serve(download_name)","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.run(['tail', '-f', log_path])","corrupted":"import os; os.system('tail -f ' + log_path)","clean_label":0,"corrupted_label":1},{"clean":"cursor.execute('DELETE FROM cart WHERE user_id = ? AND item_id = ?', (uid, iid))","corrupted":"cursor.execute(f'DELETE FROM cart WHERE user_id = {uid} AND item_id = {iid}')","clean_label":0,"corrupted_label":1},{"clean":"import hashlib; h = hashlib.sha3_512(document.encode()).hexdigest()","corrupted":"import hashlib; h = hashlib.md5(document.encode()).hexdigest()","clean_label":0,"corrupted_label":1},{"clean":"from jinja2 import escape; safe_tag = escape(tag_name)","corrupted":"safe_tag = tag_name","clean_label":0,"corrupted_label":1},{"clean":"import subprocess; subprocess.Popen(['systemctl', 'restart', service_name])","corrupted":"import os; os.system('systemctl restart ' + service_name)","clean_label":0,"corrupted_label":1},{"clean":"db.execute('SELECT * FROM invoices WHERE vendor = ? AND paid = ?', (v, 0))","corrupted":"db.execute('SELECT * FROM invoices WHERE vendor = \"' + v + '\" AND paid = 0')","clean_label":0,"corrupted_label":1},{"clean":"import os; real_p = os.path.realpath(req_path); assert real_p.startswith(ROOT)","corrupted":"content = open(req_path).read()","clean_label":0,"corrupted_label":1},{"clean":"import json; options = json.loads(opts_text)","corrupted":"options = eval(opts_text)","clean_label":0,"corrupted_label":1},{"clean":"import bcrypt; match = bcrypt.checkpw(attempt.encode(), db_hash)","corrupted":"match = (attempt == db_plaintext)","clean_label":0,"corrupted_label":1},{"clean":"response.headers['Referrer-Policy'] = 'strict-origin-when-cross-origin'","corrupted":"response.headers['Referrer-Policy'] = 'unsafe-url'","clean_label":0,"corrupted_label":1}]
